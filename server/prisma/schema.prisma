generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model Account {
    account_id      Int        @id @default (autoincrement())
    username        String     @db.VarChar(100)  @unique
    password        String     @db.VarChar(100)  
    phone           String     @db.VarChar(15)   @unique
    email           String     @db.VarChar(100)  @unique 
    verify_email    String?    @db.VarChar(100)
    verify_otp      Int?
    expired_otp     DateTime?        
    refresh_token   String?    @db.Text
    status          Int        @db.TinyInt                                
    createdAt       DateTime   @default(now())                            
    updatedAt       DateTime   @updatedAt  

    role_id    Int
    role   Role @relation(fields: [role_id], references: [role_id])
  
    @@index([role_id])

    personnel Personnel[]
    customer Customer[]
}

model Action {
  action_id         Int       @id @default(autoincrement())           
  action_name       String    @db.VarChar(100) @unique                 
  description       String?   @db.Text                                  
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  rolePermissionAction  RolePermissionAction[]  
}

model Address {
  address_id        Int       @id @default(autoincrement())           
  fullname          String    @db.VarChar(100)           
  phone             String?   @db.VarChar(15) 
  address           String    @db.VarChar(100)
  is_main           Boolean   @default(false)                                 
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  customer_id    Int
  customer   Customer @relation(fields: [customer_id], references: [customer_id])
  
    @@index([customer_id]) 
}

model Attribute {
    attribute_id        Int         @id @default (autoincrement())
    attribute_name      String      @db.VarChar(100)     @unique
    attribute_slug      String      @db.VarChar(100)     @unique
    attribute_type      String      @db.VarChar(100)
    is_custom           Boolean     @default(false)
    status              Int         @db.TinyInt                                
    createdAt           DateTime    @default(now())                            
    updatedAt           DateTime    @updatedAt  

    attributeValue  AttributeValue[]
    variantAttributeValue  VariantAttributeValue[]
    categoryAttribute   CategoryAttribute[]
}

model AttributeValue {
    value_id        Int         @id @default (autoincrement())
    value           String      @db.VarChar(100)    
    display_order   Int         @db.TinyInt
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    attribute_id    Int
    attribute   Attribute @relation(fields: [attribute_id], references: [attribute_id])
  
    @@index([attribute_id])

    variantAttributeValue  VariantAttributeValue[]
}

model Brand {
  brand_id        Int         @id @default(autoincrement())           
  brand_name      String      @db.VarChar(100) @unique                 
  brand_slug      String      @db.VarChar(100) @unique               
  description     String?     @db.Text                                  
  image_url       String?     @db.Text                                   
  status          Int         @db.TinyInt                                
  createdAt       DateTime    @default(now())                            
  updatedAt       DateTime    @updatedAt                                 
  
  product Product[]
}

model Cart {
    cart_id          Int         @id @default (autoincrement())
    total_price     Decimal?     @db.Decimal(10,2)
    total_cost      Decimal?     @db.Decimal(10,2)
    total_discount  Decimal?     @db.Decimal(10,2)
    coupon_code     String?      @db.VarChar(50)                           
    note            String?      @db.VarChar(250)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    customer_id    Int
    customer   Customer @relation(fields: [customer_id], references: [customer_id])
  
    @@index([customer_id])

    cartItem        CartItem[]
}

model CartItem {
    item_id          Int         @id @default (autoincrement())
    quantity        Int?
    price_at_time   Decimal?     @db.Decimal(10,2)
    promotion_price Decimal?     @db.Decimal(10,2)                          
    is_active       Boolean?     @default(false)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    cart_id    Int
    cart   Cart @relation(fields: [cart_id], references: [cart_id])
    variant_id    Int
    productVariant   ProductVariant @relation(fields: [variant_id], references: [variant_id])
  
    @@index([cart_id])
    @@index([variant_id])
}

model Category {
  category_id       Int       @id @default(autoincrement())           
  category_name     String    @db.VarChar(100) @unique                 
  category_slug     String    @db.VarChar(100) @unique               
  description       String?   @db.Text                                  
  image_url         String?   @db.Text                                   
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  categoryProduct CategoryProduct[]
  categoryAttribute   CategoryAttribute[]
}

model CategoryAttribute {
  id       Int       @id @default(autoincrement())                        
  description       String?   @db.Text                                  
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  category_id    Int
    category   Category @relation(fields: [category_id], references: [category_id])
  attribute_id    Int
    attribute   Attribute @relation(fields: [attribute_id], references: [attribute_id])

    @@index([category_id]) 
    @@index([attribute_id]) 
}

model CategoryProduct {
  category_product_id       Int       @id @default(autoincrement())           
  category_product_name     String    @db.VarChar(100) @unique                 
  category_product_slug     String    @db.VarChar(100) @unique               
  description       String?   @db.Text                                  
  image_url         String?   @db.Text                                   
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt  

  category_id    Int
  category   Category @relation(fields: [category_id], references: [category_id])  

  @@index([category_id])                             
  
  product Product[]
}

model Contact {
  contact_id       Int        @id @default(autoincrement())           
  fullname        String      @db.VarChar(100)               
  email           String      @db.VarChar(100)                
  phone           String      @db.VarChar(100)                
  subject         String      @db.Text                                  
  message         String      @db.Text                                  
  contact_type      String    @db.VarChar(200)                
  response          String?   @db.Text 
  response_at       DateTime?
  is_featured       Boolean?                           
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
    personnel_id    Int
    personnel   Personnel @relation(fields: [personnel_id], references: [personnel_id])
    customer_id    Int
    customer   Customer @relation(fields: [customer_id], references: [customer_id])
  
    @@index([personnel_id])
    @@index([customer_id])
}

model Coupon {
  coupon_id         Int         @id @default(autoincrement())           
  code              String      @db.VarChar(50)  @unique       // Mã code áp dụng
  max_uses          Int         @default(0)           // Số lần sử dụng
  min_order_value   Int         @default(0)           // Giá trị tối thiểu khi sử dụng
  used_count        Int         @default(0)           // Số lượng đã sử dụng
  user_restriction  String?      @db.VarChar(100)     // Giới hạn người dùng
  expiry_date       DateTime                          // Hạn sử dụng mã
  usage_limit_per_customer  Int     @default(0)       // Giới hạn sử dụng cho mõi khách hàng
  is_public         Boolean         @default(false)   // Mã công khai hay chỉ private               
  status            Int           @db.TinyInt                                
  createdAt         DateTime      @default(now())                            
  updatedAt         DateTime      @updatedAt                                 
  
  promotion_id      Int
  promotion   Promotion @relation(fields: [promotion_id], references: [promotion_id])
    
  @@index([promotion_id])

  couponUsageHistory  CouponUsageHistory[]
}

model CouponUsageHistory {
  history_id        Int           @id @default(autoincrement())           
  used_at           Int           @default(0)         // Số lần sử dụng
  discount_value    Decimal       @db.Decimal(10,2)   // Giá trị giảm giá đã dùng             
  status            Int           @db.TinyInt                                
  createdAt         DateTime      @default(now())                            
  updatedAt         DateTime      @updatedAt                                 
  
  coupon_id      Int
  coupon   Coupon @relation(fields: [coupon_id], references: [coupon_id])
  customer_id      Int
  customer   Customer @relation(fields: [customer_id], references: [customer_id])
  order_id      Int
  order   Order @relation(fields: [order_id], references: [order_id])
    
  @@index([coupon_id])
  @@index([customer_id])
  @@index([order_id])
}

model Customer {
    customer_id     Int         @id @default (autoincrement())
    fullname        String      @db.VarChar(100)
    gender          Int?         @db.TinyInt
    birthday        DateTime?    @db.DateTime
    points          Int?        @default(0)
    address         String?      @db.VarChar(100)
    avatar          String?      @db.Text
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    account_id    Int    @unique
    account   Account @relation(fields: [account_id], references: [account_id])
    group_id    Int
    group   CustomerGroup @relation(fields: [group_id], references: [group_id])
  
    @@index([account_id])
    @@index([group_id])

    productReview   ProductReview[]
    productComment  ProductComment[]
    addressFK         Address[]
    couponUsageHistory  CouponUsageHistory[]
    order           Order[]
    returnOrder     ReturnOrder[]
    cart            Cart[]
    contact         Contact[]
    favorite        FavoriteProduct[]
}

model CustomerGroup {
    group_id        Int         @id @default (autoincrement())
    group_name      String      @db.VarChar(100)     @unique
    description     String?      @db.VarChar(255)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    customers Customer[]
}

model FavoriteProduct {
    favorite_id         Int         @id @default (autoincrement())
    favorite_date       DateTime
    status              Int         @db.TinyInt                                
    createdAt           DateTime    @default(now())                            
    updatedAt           DateTime    @updatedAt  


    product_id      Int
    product   Product @relation(fields: [product_id], references: [product_id])
    customer_id      Int
    customer   Customer @relation(fields: [customer_id], references: [customer_id])
    
    @@index([product_id])
    @@index([customer_id])
}

model ImgProduct {
    img_id Int      @id         @default (autoincrement())
    image_url       String      @db.VarChar(255)
    is_main         Boolean?     @default(false)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  


    product_id      Int
    product   Product @relation(fields: [product_id], references: [product_id])
    @@index([product_id])
}

model ImgProductDetail {
    img_id Int      @id         @default (autoincrement())
    image_url       String      @db.VarChar(255)
    is_main         Boolean?     @default(false)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  


    variant_id      Int
    productVariant   ProductVariant @relation(fields: [variant_id], references: [variant_id])
  
    @@index([variant_id])
}

model Inventory {
  inventory_id        Int           @id @default(autoincrement())                        
  quantity            Int           @db.TinyInt 
  avg_cost            Decimal       @db.Decimal(10,2)                               
  last_import_price   Decimal       @db.Decimal(10,2)  // Giá nhập mới nhất                             
  status            Int           @db.TinyInt                                
  createdAt         DateTime      @default(now())                            
  updatedAt         DateTime      @updatedAt                                 
  
  warehouse_id      Int
  warehouse   Warehouse @relation(fields: [warehouse_id], references: [warehouse_id])
  variant_id      Int
  variant   ProductVariant @relation(fields: [variant_id], references: [variant_id])
    
  @@index([warehouse_id])
  @@index([variant_id])

  
}

model News {
  news_id       Int       @id @default(autoincrement())           
  news_title    String    @db.VarChar(100) @unique               
  summary       String    @db.Text                
  news_slug     String    @db.VarChar(100) @unique               
  content       String?   @db.Text                                  
  image_url         String?   @db.Text 
  view_count        Int       @default(0)
  publish_date      DateTime
  is_featured       Boolean                           
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
    personnel_id    Int
    personnel   Personnel @relation(fields: [personnel_id], references: [personnel_id])
  
    @@index([personnel_id])
}

model Order {
    order_id        Int         @id @default (autoincrement())
    order_code      String      @db.VarChar(20)             // Mã đơn hàng
    total_price     Decimal     @db.Decimal(10,2)           // Tổng tiền sau KM
    total_cost      Decimal     @db.Decimal(10,2)           // Tổng giá vốn tại thời điểm
    total_discount  Decimal     @db.Decimal(10,2)           // Tổng khuyến mãi
    coupon_code     String      @db.VarChar(50)             // Mã giảm giá áp dụng
    shipping_fee    Decimal     @db.Decimal(10,2)           // Phí vận chuyển
    recipient_name  String      @db.VarChar(50)             // Tên người nhận
    recipient_phone String      @db.VarChar(50)             // Số điện thoại người nhận
    shipping_address    String      @db.VarChar(250)        // Địa chỉ nhận hàng
    note            String      @db.Text
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    customer_id    Int
    customer   Customer @relation(fields: [customer_id], references: [customer_id])
    promotion_id    Int
    promotion   Promotion @relation(fields: [promotion_id], references: [promotion_id])
    shipping_id    Int
    shipping   ShippingMethod @relation(fields: [shipping_id], references: [shipping_id])
    payment_id    Int
    payment   Payment @relation(fields: [payment_id], references: [payment_id])
    
  
    @@index([customer_id])
    @@index([promotion_id])
    @@index([shipping_id])
    @@index([payment_id])

    couponUsageHistory  CouponUsageHistory[]
    orderDetail         OrderDetail[]
    returnOrder         ReturnOrder[]
    orderConfirmation   OrderConfirmation[]
}

model OrderConfirmation {
    confirmation_id     Int         @id @default (autoincrement())
    confirmed_at        DateTime              // Thời gian xác nhận
    confirmed_status    String      @db.VarChar(50)   // Thời gian xác nhận
    source              String      @db.VarChar(50)   // Xác nhận                           
    note                String      @db.Text                          
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    order_id    Int
    order   Order @relation(fields: [order_id], references: [order_id])
    personnel_id    Int
    personnel   Personnel @relation(fields: [personnel_id], references: [personnel_id])
  
    @@index([order_id])
    @@index([personnel_id])
}

model OrderDetail {
    order_detail_id          Int         @id @default (autoincrement())
    quantity        Int         
    price_sell      Decimal     @db.Decimal(10,2)   // Giá trước khuyến mãi
    discount        Decimal     @db.Decimal(10,2)   // Tổng giảm giá                           
    final_price     Decimal     @db.Decimal(10,2)   // Tổng giảm giá x số lượng                        
    cost_price      Decimal     @db.Decimal(10,2)   // Giá vốn tại thời điểm bán                         
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    order_id    Int
    order   Order @relation(fields: [order_id], references: [order_id])
    variant_id    Int
    variant   ProductVariant @relation(fields: [variant_id], references: [variant_id])
  
    @@index([order_id])
    @@index([variant_id])
}

model Payment {
  payment_id        Int       @id @default(autoincrement())           
  payment_method    String      @db.VarChar(50)    @unique                        
  payment_code      String      @db.VarChar(50)    @unique
  amount            Decimal     @db.Decimal(10,2) // Số tiền thanh toán
  payment_status    Int         @db.TinyInt       // Trạng thái thanh toán
  payment_date      DateTime                      // Thời gian
  payment_detail    String      @db.Text          // Chi tiết phản hồi
  back_code         String      @db.VarChar(50)
  card_type         String      @db.VarChar(50)
  note              String      @db.Text                         
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt   

  order           Order[]                              
}

model PaymentGateway {
  gateway_id        Int         @id @default(autoincrement())           
  gateway_name      String      @db.VarChar(100)   @unique                         
  gateway_code      String      @db.VarChar(100)   @unique
  merchant_id       String      @db.VarChar(100)   @unique
  merchant_key      String      @db.VarChar(255)   @unique
  config            String      @db.Text 
  is_active         Boolean
  fee_percentage    Decimal     @db.Decimal(10,2)
  fee_fixed         Decimal     @db.Decimal(10,2)
  description       String      @db.Text                        
  note              String      @db.Text                        
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
}

model Permission {
  permission_id         Int       @id @default(autoincrement())           
  permission_name       String    @db.VarChar(100) @unique                 
  description       String?   @db.Text                                  
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  rolePermissionAction  RolePermissionAction[]
}

model Personnel {
    personnel_id     Int         @id @default (autoincrement())
    fullname        String      @db.VarChar(100)
    gender          Int         @db.TinyInt
    birthday        DateTime    @db.DateTime
    cccd            Int
    address         String      @db.VarChar(100)
    avatar          String      @db.Text
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    account_id    Int
    account   Account @relation(fields: [account_id], references: [account_id])
  
    @@index([account_id])

    productComment   ProductComment[]
    purchaseOrder   PurchaseOrder[]
    news            News[]
    contacts         Contact[]
    orderConfirmation   OrderConfirmation[]
}

model Product {
    product_id          Int         @id @default (autoincrement())
    product_name        String      @db.VarChar(100)     @unique
    product_slug        String      @db.VarChar(100)     @unique
    product_sku         String      @db.VarChar(50)      @unique
    views               Int
    description         String      @db.Text
    status              Int         @db.TinyInt                                
    createdAt           DateTime    @default(now())                            
    updatedAt           DateTime    @updatedAt  


    category_product_id         Int
    categoryProduct   CategoryProduct @relation(fields: [category_product_id], references: [category_product_id])
    brand_id            Int
    brand   Brand @relation(fields: [brand_id], references: [brand_id])
  

    @@index([category_product_id])
    @@index([brand_id])

    productVariant  ProductVariant[]
    productComment  ProductComment[]
    productReview   ProductReview[]
    imgProductFK    ImgProduct[]
    favorite        FavoriteProduct[]
}

model ProductComment {
    comment_id      Int         @id @default (autoincrement())
    parent_id       Int?      
    content         String      @db.VarChar(255)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  


    product_id      Int
    product   Product @relation(fields: [product_id], references: [product_id])
    customer_id     Int
    customer   Customer @relation(fields: [customer_id], references: [customer_id])
    personnel_id    Int
    personnel   Personnel @relation(fields: [personnel_id], references: [personnel_id])
  

    @@index([product_id])
    @@index([customer_id])
    @@index([personnel_id])
}

model ProductReview {
    review_id       Int         @id @default (autoincrement())
    rating          Int?        @default(0)
    content         String?     @db.Text
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  


    product_id      Int
    product   Product @relation(fields: [product_id], references: [product_id])
    customer_id     Int
    customer   Customer @relation(fields: [customer_id], references: [customer_id])
  

    @@index([product_id])
    @@index([customer_id])
}

model ProductVariant {
    variant_id      Int         @id @default (autoincrement())
    sku             String      @db.VarChar(100)     @unique  
    description     String      @db.VarChar(255)
    avg_cost        Decimal      @db.Decimal(10,2)
    price_sell      Decimal      @db.Decimal(10,2)                   // Gia ban mac dinh
    price_original  Decimal      @db.Decimal(10,2)                   // Gia goc khong giam
    is_default      Boolean     @default(false)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  


    product_id      Int
    product   Product @relation(fields: [product_id], references: [product_id])
    
    @@index([product_id])

    promotionDetail     PromotionDetail[]
    inventory           Inventory[]
    purchaseOrderDetail PurchaseOrderDetail[]
    orderDetail         OrderDetail[]
    returnOrderDetail   ReturnOrderDetail[]
    cartItem            CartItem[]
    imgProductDetail    ImgProductDetail[]
}

model Promotion {
  promotion_id        Int         @id @default(autoincrement())           
  promotion_name      String      @db.VarChar(100) @unique                 
  promotion_slug      String      @db.VarChar(100) @unique               
  description     String?         @db.Text 
  start_date      DateTime                                 
  end_date        DateTime  
  is_active       Boolean   
  priority        Int?                              
  promotion_type  String        @db.VarChar(100)                                   
  status          Int           @db.TinyInt                                
  createdAt       DateTime      @default(now())                            
  updatedAt       DateTime      @updatedAt                                 
  
  promotionRule     PromotionRule[]
  promotionAction   PromotionAction[]
  promotionCoupon   Coupon[]
  promotionDetail   PromotionDetail[]
  order             Order[]
}

model PromotionAction {
  action_id       Int         @id @default(autoincrement())           
  action_type     String      @db.VarChar(255)   @unique                 
  action_value    String      @db.VarChar(255)                 
  status          Int           @db.TinyInt                                
  createdAt       DateTime      @default(now())                            
  updatedAt       DateTime      @updatedAt                                 
  
  promotion_id      Int
  promotion   Promotion @relation(fields: [promotion_id], references: [promotion_id])
    
  @@index([promotion_id])

  
}

model PromotionDetail {
  detail_id        Int         @id @default(autoincrement())                        
  status            Int           @db.TinyInt                                
  createdAt         DateTime      @default(now())                            
  updatedAt         DateTime      @updatedAt                                 
  
  promotion_id      Int
  promotion   Promotion @relation(fields: [promotion_id], references: [promotion_id])
  variant_id      Int
  variant   ProductVariant @relation(fields: [variant_id], references: [variant_id])
    
  @@index([promotion_id])
  @@index([variant_id])

}

model PromotionRule {
  rule_id        Int         @id @default(autoincrement())           
  rule_type      String      @db.VarChar(255)    @unique                
  condition_value      String      @db.VarChar(255)                                                
  status          Int           @db.TinyInt                                
  createdAt       DateTime      @default(now())                            
  updatedAt       DateTime      @updatedAt                                 
  
  promotion_id      Int
  promotion   Promotion @relation(fields: [promotion_id], references: [promotion_id])
    
  @@index([promotion_id])

}

model PurchaseOrder {
    po_id          Int         @id @default (autoincrement())
    supplier_name   String      @db.VarChar(100)                          
    note            String      @db.VarChar(100)                          
    total_price     Decimal     @db.Decimal(10,2)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    personnel_id    Int
    personnel   Personnel @relation(fields: [personnel_id], references: [personnel_id])
  
    @@index([personnel_id])

    purchaseOrderDetail PurchaseOrderDetail[]
}

model PurchaseOrderDetail {
    pod_id          Int         @id @default (autoincrement())
    quantity        Int         @db.TinyInt     
    price_import    Decimal     @db.Decimal(10,2)
    unit            String       @db.VarChar(50)                           
    total_price     Decimal     @db.Decimal(10,2)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    po_id    Int
    purchaseOrder   PurchaseOrder @relation(fields: [po_id], references: [po_id])
    variant_id    Int
    productVariant   ProductVariant @relation(fields: [variant_id], references: [variant_id])
  
    @@index([po_id])
    @@index([variant_id])
}

model ReturnOrder {
    return_id          Int         @id @default (autoincrement())
    total_refund    Decimal     @db.Decimal(10,2)
    return_reason   String      @db.VarChar(250)                           
    note            String      @db.VarChar(250)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    order_id    Int
    order   Order @relation(fields: [order_id], references: [order_id])
    customer_id    Int
    customer   Customer @relation(fields: [customer_id], references: [customer_id])
    warehouse_id    Int
    warehouse   Warehouse @relation(fields: [warehouse_id], references: [warehouse_id])
  
    @@index([order_id])
    @@index([customer_id])
    @@index([warehouse_id])

    returnOrderDetail   ReturnOrderDetail[]
}

model ReturnOrderDetail {
    return_detail_id          Int         @id @default (autoincrement())
    quantity        Int         @db.TinyInt     
    unit            String       @db.VarChar(50)                           
    refund_price    Decimal     @db.Decimal(10,2)
    restock         Boolean     
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    return_id    Int
    returnOrder   ReturnOrder @relation(fields: [return_id], references: [return_id])
    variant_id    Int
    productVariant   ProductVariant @relation(fields: [variant_id], references: [variant_id])
    
  
    @@index([return_id])
    @@index([variant_id])
}

model Role {
  role_id           Int       @id @default(autoincrement())           
  role_name         String    @db.VarChar(100) @unique                 
  role_slug         String    @db.VarChar(100) @unique               
  description       String   @db.Text                                  
  is_system         Boolean                                      
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  account Account[]
  rolePermissionAction  RolePermissionAction[]
}

model RolePermissionAction {
  id         Int       @id @default(autoincrement())           
  description       String?   @db.Text                                  
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt  

    role_id    Int
    role   Role @relation(fields: [role_id], references: [role_id])
    permission_id        Int
    permission   Permission @relation(fields: [permission_id], references: [permission_id])
    action_id        Int
    action   Action @relation(fields: [action_id], references: [action_id])
  
    @@index([role_id])
    @@index([permission_id])                               
    @@index([action_id])                               
  
}

model ShippingMethod {
  shipping_id        Int       @id @default(autoincrement())           
  shipping_code     String      @db.VarChar(50)    @unique    // Mã định danh                     
  shipping_name     String      @db.VarChar(100)   // Mô tả chi tiết  
  description       String      @db.Text            
  fee_type          String      @db.VarChar(100)   // Cách tính phí
  carrier           String      @db.VarChar(250)   // Đơn vị vận chuyển
  is_active         Boolean     @default(false)
  delivery_time     String      @db.VarChar(100)   // Thời gian giao hàng
  base_fee          Decimal     @db.Decimal(10,2)  // Phí cơ bản
  free_threshold    Decimal     @db.Decimal(10,2)  // Miễn phí từ giá trị này                          
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  order           Order[]
}

model VariantAttributeValue {
    id              Int         @id @default (autoincrement())
    custom_value    String      @db.VarChar(100)
    status          Int         @db.TinyInt                                
    createdAt       DateTime    @default(now())                            
    updatedAt       DateTime    @updatedAt  

    attribute_id    Int
    attribute   Attribute @relation(fields: [attribute_id], references: [attribute_id])
    value_id        Int
    attributeValue   AttributeValue @relation(fields: [value_id], references: [value_id])
  
    @@index([attribute_id])
    @@index([value_id])
}

model Warehouse {
  warehouse_id           Int       @id @default(autoincrement())           
  warehouse_name         String    @db.VarChar(100) @unique                 
  address           String    @db.VarChar(100)              
  description       String   @db.Text                                  
  status            Int       @db.TinyInt                                
  createdAt         DateTime  @default(now())                            
  updatedAt         DateTime  @updatedAt                                 
  
  inventory           Inventory[]
   returnOrder         ReturnOrder[]
}